# Supabase Configuration
# ======================
# Get these from your Supabase project dashboard

# Public URL for your Supabase project (safe to expose to client)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co

# Anonymous/public API key (safe to expose to client)
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# Service role key (NEVER expose to client, server-side only)
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# Direct database connection (for migrations, admin tasks)
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.your-project-ref.supabase.co:5432/postgres

# Google OAuth Configuration (Optional)
# ====================================
# Required if using Google Sign-In
# Get these from Google Cloud Console

GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# Google reCAPTCHA v3 Configuration (Optional)
# ============================================
# Required for contact form spam protection
# Get these from https://www.google.com/recaptcha/admin

# Public site key (safe to expose to client)
NEXT_PUBLIC_RECAPTCHA_SITE_KEY=your_recaptcha_site_key

# Secret key (NEVER expose to client, server-side only)
RECAPTCHA_SECRET_KEY=your_recaptcha_secret_key

# Mapbox Configuration (Required for live driver tracking map)
# =============================================================
# Get this from https://account.mapbox.com/access-tokens/
# Free tier includes 50,000 map loads per month
#
# SECURITY: After creating your token, restrict it to your domain(s)
# in the Mapbox dashboard to prevent unauthorized usage:
# https://account.mapbox.com/access-tokens/
# Add URL restrictions: https://yourdomain.com/*

# Mapbox access token (safe to expose to client)
NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN=your_mapbox_access_token

# Supabase Realtime Feature Flags (Optional)
# ===========================================
# Control real-time tracking features powered by Supabase Realtime (WebSocket)
# These flags enable gradual rollout and A/B testing of realtime features
#
# Enabled by default for development/testing. For production, set based on
# your infrastructure readiness and desired rollout percentage.

# Enable real-time location updates via WebSocket (recommended: true)
# When enabled, driver locations broadcast instantly via Supabase Realtime
# When disabled, falls back to REST API with polling
NEXT_PUBLIC_FF_USE_REALTIME_LOCATION_UPDATES=true

# Enable real-time admin dashboard updates (recommended: true)
# When enabled, admin sees live driver updates via WebSocket
# When disabled, admin dashboard polls via SSE every 5 seconds
NEXT_PUBLIC_FF_USE_REALTIME_ADMIN_DASHBOARD=true

# Enable automatic fallback to SSE when WebSocket unavailable (recommended: true)
# Ensures admin dashboard continues working even if Realtime connection fails
# Should always be true for production reliability
NEXT_PUBLIC_FF_REALTIME_FALLBACK_TO_SSE=true

# Enable fallback to REST when both Realtime and SSE fail (recommended: true)
# Final fallback layer for maximum reliability
NEXT_PUBLIC_FF_REALTIME_FALLBACK_TO_REST=true

# Notes:
# - Supabase Realtime uses Phoenix Channels (WebSocket) for pub/sub
# - No custom server required - fully serverless compatible
# - Authentication inherited from Supabase client
# - Test simulator available at: /admin/tracking/test-driver
# - Admin dashboard at: /admin/tracking

# Minimum reCAPTCHA score threshold (0.0 to 1.0, default: 0.5)
# 0.0 = Very likely a bot
# 0.5 = Neutral (Google's recommendation)
# 1.0 = Very likely a human
# Adjust based on your spam patterns and false positive rate
RECAPTCHA_MIN_SCORE=0.5

# Spam Protection Configuration
# ==============================
# Trust proxy headers (x-forwarded-for, x-real-ip) for IP extraction
# Set to 'false' if not behind a trusted proxy (Vercel, Cloudflare, etc.)
# Default: true (assumes production deployment behind trusted proxy)
# IMPORTANT: Set to 'false' in local development or untrusted environments
TRUST_PROXY=true

# OpenAI Configuration (Optional)
# ===============================
# Required for AI features

OPENAI_API_KEY=your_openai_api_key

# Sentry Configuration (Error Monitoring)
# ========================================
# Required for error tracking and monitoring in production
# Get these from https://sentry.io/

# Data Source Name (DSN) - safe to expose to client
# This is the public key that identifies your Sentry project
# Format: https://[key]@[organization].ingest.sentry.io/[project-id]
NEXT_PUBLIC_SENTRY_DSN="https://your_key_here@your_org.ingest.sentry.io/your_project_id"

# Sentry Authentication Token (NEVER expose to client, build-time only)
# Required for uploading source maps during build
# Generate from: Settings > Auth Tokens
# Scopes needed: project:releases, project:write, org:read
SENTRY_AUTH_TOKEN="sntryu_your_auth_token_here"

# Sentry Organization slug (from your Sentry URL)
SENTRY_ORG="your-organization-slug"

# Sentry Project name (from your Sentry project settings)
SENTRY_PROJECT="your-project-name"

# Sentry Trace Sample Rate (Optional, for performance monitoring)
# Controls what percentage of transactions are sent to Sentry
# 0.0 = No traces sent (disables performance monitoring)
# 0.1 = 10% of transactions (recommended for production)
# 1.0 = 100% of transactions (recommended for development)
# Default: 0.1 in production, 1.0 in development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Instructions:
# =============
# 1. Create a Sentry account at https://sentry.io
# 2. Create a new project for "Next.js"
# 3. Copy the DSN from the project settings
# 4. Generate an auth token: Settings > Auth Tokens > Create New Token
#    - Scopes needed: project:releases, project:write, org:read
# 5. Add all variables to your .env.local for development
# 6. For production, add to your hosting platform's environment variables

# Local Development Testing (Optional)
# =====================================
# For local testing without a real Sentry account:
# 1. Leave NEXT_PUBLIC_SENTRY_DSN empty to disable Sentry
#    NEXT_PUBLIC_SENTRY_DSN=""
# 2. Or use a test/development DSN from Sentry's free tier
# 3. Test endpoints: Visit /test-sentry or /api/test-sentry?type=error
# 4. Check console for "Sentry DSN not configured" warning when disabled

# Firebase Cloud Messaging Configuration (Push Notifications)
# =============================================================
# Required for PWA push notifications to drivers and customers
# Get these from Firebase Console: https://console.firebase.google.com/
#
# Setup Steps:
# 1. Create a Firebase project at https://console.firebase.google.com/
# 2. Go to Project Settings > General > Your apps > Add app (Web)
# 3. Copy the config values from the Firebase SDK snippet
# 4. For VAPID key: Project Settings > Cloud Messaging > Web Push certificates
# 5. For Admin SDK: Project Settings > Service accounts > Generate new private key

# Client-side Firebase Config (safe to expose to client)
NEXT_PUBLIC_FIREBASE_API_KEY=your_firebase_api_key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=123456789012
NEXT_PUBLIC_FIREBASE_APP_ID=1:123456789012:web:abc123def456
NEXT_PUBLIC_FIREBASE_VAPID_KEY=your_vapid_key_for_web_push

# Server-side Firebase Admin SDK (NEVER expose to client)
# These are from the service account JSON file
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour Private Key Here\n-----END PRIVATE KEY-----\n"

# Notes:
# - Push notifications work on PWA-enabled browsers (Chrome, Edge, Safari 16.4+)
# - Users must grant notification permission when prompted
# - Service worker handles background push at /firebase-messaging-sw.js
# - Test notifications at: /admin/notifications/test

# Vercel Cron Configuration (Production Only)
# ===========================================
# Required for securing cron endpoints in production
# This secret is used to authenticate Vercel Cron job requests

# Generate a secure random secret using one of these methods:
# - Node.js: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# - OpenSSL: openssl rand -base64 32
# - Online: https://generate-secret.vercel.app/32
CRON_SECRET=your_cron_secret_here

# How to configure in Vercel:
# 1. Generate a secure random secret (see commands above)
# 2. Add to Vercel project: Settings > Environment Variables
# 3. Set variable name: CRON_SECRET
# 4. Set value: your generated secret
# 5. Select environments: Production (and Preview if needed)
# 6. Save changes
#
# Note: This is automatically used by Vercel Cron jobs configured in vercel.json
# See: /api/admin/quarantine-cleanup for cron endpoint implementation

# Development Environment Variables
# =================================
# These are typically used in development

# Next.js Environment
NODE_ENV=development

# Additional configuration
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Testing Configuration
# =====================
# These are used by Jest for testing

TEST_DATABASE_URL=postgresql://test:test@localhost:5432/test_db
NEXT_PUBLIC_TEST_SUPABASE_URL=https://test.supabase.co
NEXT_PUBLIC_TEST_SUPABASE_ANON_KEY=test-anon-key
TEST_SUPABASE_SERVICE_ROLE_KEY=test-service-role-key

# Instructions:
# =============
# 1. Copy this file to .env.local for development
# 2. Replace all placeholder values with your actual credentials
# 3. Never commit .env.local to version control
# 4. For production, set these variables in your hosting platform

# Development Project Credentials (rs-dev)
# ==========================================
# Ready to use for development branch:
# NEXT_PUBLIC_SUPABASE_URL=https://khvteminrbghoeuqajzm.supabase.co
# NEXT_PUBLIC_SUPABASE_ANON_KEY=[Get from Supabase dashboard]
# SUPABASE_SERVICE_ROLE_KEY=[Get from Supabase dashboard]
